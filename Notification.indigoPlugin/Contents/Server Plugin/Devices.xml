<?xml version="1.0"?>
<Devices>
	<Device type="custom" id="notificationPerson">
		<Name>Person notification settings</Name>
		<ConfigUI>
			<Field type="label" id="intro">
				<Label>
Enter your information regarding the person to receive notifications</Label>
			</Field>
			<Field type="label" id="introspace">
				<Label> </Label>
			</Field>
			<Field type="checkbox" id="enable" defaultValue="true">
				<Label>Enable notifications:</Label>
				<Description>To temporarily disable notifications etc.</Description>
			</Field>
			<Field type="menu" id="presenceVariable">
				<Label>Presence variable:</Label>
				<List class="indigo.variables" filter=""/>
			</Field>
			<Field type="label" id="personVariableGuidance" alignWithControl="true">
				<Label>Select an (optional) variable that is true when person is present. If presence is not activated in notification category this will not have any effect</Label>
			</Field>
			<Field type="label" id="introNotification">
				<Label>
				
Notification delivery options</Label>
			</Field>
			<Field id="simpleSeparator1" type="separator"/>
			<Field type="textfield" id="email">
				<Label>E-mail address:</Label>
			</Field>
			<Field type="list" id="growlTypes" rows="8">
				<Label>Growl notification types:</Label>
				<List class="com.perceptiveautomation.indigoplugin.growl" filter="" method="getNotificationList"/>
			</Field>
			<Field type="label" id="growlGuidance" alignWithControl="true">
				<Label>Select growl notification type(s) that are "linked" to the person. When creating a notification using this plugin you will choose which growl notification types to use. This way the plugin can determine which growl types are to be sent based on presence.</Label>
			</Field>
			<Field type="menu" id="logVariable">
				<Label>Log variable:</Label>
				<List class="indigo.variables" filter=""/>
			</Field>
			<Field type="label" id="personLogVariableGuidance" alignWithControl="true">
				<Label>When specified, the plugin will write the last notification to that variable
				</Label>
			</Field>
		</ConfigUI>
		<States>
			<State id="lastNotificationTime">
				<ValueType>String</ValueType>
				<TriggerLabel>Last notification time</TriggerLabel>
				<ControlPageLabel>Last notification time</ControlPageLabel>
			</State>
			<State id="lastNotificationIdentifier">
				<ValueType>String</ValueType>
				<TriggerLabel>Last notification identifier</TriggerLabel>
				<ControlPageLabel>Last notification identifier</ControlPageLabel>
			</State>
			<State id="lastNotificationText">
				<ValueType>String</ValueType>
				<TriggerLabel>Last notification text</TriggerLabel>
				<ControlPageLabel>Last notification text</ControlPageLabel>
			</State>
			<State id="lastNotificationCategory">
				<ValueType>String</ValueType>
				<TriggerLabel>Last notification category</TriggerLabel>
				<ControlPageLabel>Last notification category</ControlPageLabel>
			</State>
			<State id="present">
				<ValueType>Boolean</ValueType>
				<TriggerLabel>Presence</TriggerLabel>
				<ControlPageLabel>Person is present</ControlPageLabel>
			</State>
		</States>
		<UiDisplayStateId>lastNotificationTime</UiDisplayStateId>
	</Device>
	<Device type="custom" id="notificationCategory">
		<Name>Notification category</Name>
		<ConfigUI>
			<Field type="checkbox" id="enable" defaultValue="true">
				<Label>Enable category:</Label>
				<Description>Temporarily disable this category etc.</Description>
			</Field>
			<Field type="label" id="intro">
				<Label>
Presence options</Label>
			</Field>
			<Field id="simpleSeparator0" type="separator"/>
			<Field type="checkbox" id="notifyPresent" defaultValue="false">
				<Label>Notify present only:</Label>
				<Description>Notify only those that are present, others are ignored</Description>
			</Field>
			<Field type="checkbox" id="notifyAllIfNotPresent" defaultValue="false">
				<Label>Notify all if none present:</Label>
				<Description>Notify all recipients if none are present</Description>
			</Field>
			<Field type="label" id="introNotification">
				<Label>				
How to deliver notification</Label>
			</Field>
			<Field id="simpleSeparator1" type="separator"/>
			<Field type="menu" id="sendEvery" defaultValue="always">
				<Label>Deliver:</Label>
				<List>
					<Option value="always">Always</Option>
					<Option value="1hour">Once per hour</Option>
					<Option value="12hours">Once per 12 hours</Option>
					<Option value="1day">Once per day</Option>
					<Option value="1week">Once per week</Option>
					<Option value="1month">Once per month</Option>
				</List>
			</Field>
			<Field type="label" id="infoSendEvery" visibleBindingId="sendEvery" visibleBindingValue="1hour,12hours,1day,1week,1month" alignWithControl="true">
				<Label>Notification category will not be repeated for the chosen interval</Label>
			</Field>
			<Field type="checkbox" id="log" defaultValue="true">
				<Label>Indigo log:</Label>
				<Description>Write notification to Indigo log</Description>
			</Field>
			<Field type="checkbox" id="notificationLog" defaultValue="true">
				<Label>Notification log:</Label>
				<Description>Write notification to plugin log file</Description>
			</Field>
			<Field type="textfield" id="logType">
				<Label>Log type</Label>
			</Field>
			<Field type="checkbox" id="logAsError" defaultValue="false">
				<Label>Log as error:</Label>
				<Description>Log notification as error code</Description>
			</Field>
			<Field type="checkbox" id="email" defaultValue="true">
				<Label>E-mail:</Label>
				<Description>Deliver notification as e-mail</Description>
			</Field>
			<Field type="textfield" id="alwaysDeliverEmail">
				<Label>Always deliver to e-mail:</Label>
			</Field>
			<Field type="label" id="alwaysEmailGuidance" alignWithControl="true">
				<Label>Always deliver notification to this e-mail regardless of other settings (presence etc.)</Label>
			</Field>
			<Field type="checkbox" id="push" defaultValue="false">
				<Label>Push:</Label>
				<Description>Push notification (growl)</Description>
			</Field>
			<Field type="menu" id="growlPriority" defaultValue="0" visibleBindingId="push" visibleBindingValue="true">
				<Label>Growl priority:</Label>
				<List>
					<Option value="-2">-2</Option>
					<Option value="-1">-1</Option>
					<Option value="0">0</Option>
					<Option value="1">1</Option>
					<Option value="2">2</Option>
				</List>
			</Field>
			<Field type="checkbox" id="growlSticky" defaultValue="false" visibleBindingId="push" visibleBindingValue="true">
				<Label>Growl sticky:</Label>
				<Description>Make growl notification sticky</Description>
			</Field>
			<Field type="checkbox" id="speak" defaultValue="false">
				<Label>Speech:</Label>
				<Description>Speak notification</Description>
			</Field>
			<Field type="menu" id="beforeSpeakActionGroup" visibleBindingId="speak" visibleBindingValue="true">
				<Label>Before speech action group:</Label>
				<List class="indigo.actionGroups" filter=""/>
			</Field>
			<Field type="menu" id="afterSpeakActionGroup" visibleBindingId="speak" visibleBindingValue="true">
				<Label>After speech action group:</Label>
				<List class="indigo.actionGroups" filter=""/>
			</Field>
			<Field type="label" id="introPersons">
				<Label>			
To whom to deliver notification</Label>
			</Field>
			<Field id="simpleSeparator2" type="separator"/>
			<Field type="list" id="deliverTo" rows="4">
				<Label>Deliver to persons:</Label>
				<List class="indigo.devices" filter="com.perceptiveautomation.indigoplugin.notification.notificationPerson"/>
			</Field>
			<Field type="list" id="growlTypes" rows="6" visibleBindingId="push" visibleBindingValue="true">
				<Label>Growl notification types:</Label>
				<List class="com.perceptiveautomation.indigoplugin.growl" filter="" method="getNotificationList"/>
			</Field>
			<Field type="label" id="infoPersons" visibleBindingId="notifyPresent" visibleBindingValue="true">
				<Label>
Please remember that persons may be omitted from notification due to not being present. Also if one or more growl notification types is connected to a person, this will be omitted if that person is not present</Label>
			</Field>
		</ConfigUI>
		<States>
			<State id="lastNotificationTime">
				<ValueType>String</ValueType>
				<TriggerLabel>Last notification time</TriggerLabel>
				<ControlPageLabel>Last notification time</ControlPageLabel>
			</State>
			<State id="lastNotificationIdentifier">
				<ValueType>String</ValueType>
				<TriggerLabel>Last notification identifier</TriggerLabel>
				<ControlPageLabel>Last notification identifier</ControlPageLabel>
			</State>
			<State id="lastNotificationText">
				<ValueType>String</ValueType>
				<TriggerLabel>Last notification text</TriggerLabel>
				<ControlPageLabel>Last notification text</ControlPageLabel>
			</State>
			<State id="lastNotifiedPersons">
				<ValueType>String</ValueType>
				<TriggerLabel>Last notified persons</TriggerLabel>
				<ControlPageLabel>Last notified persons</ControlPageLabel>
			</State>
		</States>
		<UiDisplayStateId>lastNotificationTime</UiDisplayStateId>
	</Device>
</Devices>
